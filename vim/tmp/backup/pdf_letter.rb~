# encoding : utf-8
class PdfLetter < Prawn::Document
  def initialize(patent)
    super()
font("Times-Roman",  :size => 10)
fill_rectangle [10,750], 10, 10 
fill_rectangle [25,750], 10, 10 
fill_rectangle [40,750], 10, 10 
pigs = "#{Rails.root.to_s}/app/assets/images/logo.png" 
image pigs, :at => [380,750], :scale => 0.3
  bounding_box [20,525], :width => 300 do
      text "Ihr Zeichen"
    font ("Times-Roman",:size=>10) do
      text "<b>"+patent.ihrzeichen+"</b>",:inline_format => true
    end
  end 

 bounding_box [200,525], :width => 300 do
    text "Unser Zeichen"
    font ("Times-Roman",:size=>9) do
      text "<b>"+patent.internaktenzeichen+"</b>",:inline_format => true
    end
 end

 bounding_box [380,525], :width => 300 do
    text "Datum"
    font ("Times-Roman",:size=>9) do
      text "<b>"+Time.now.strftime("%d.%m.%Y")+"</b>",:inline_format => true
    end
 end


fill_color "D0D0D0"
fill_rectangle [20,52], 503, 52 
fill_color "000000"
 bounding_box [23,49], :width =>250 do
   font ("Times-Roman",:size=>9) do
      text "ips UG (haftungsbeschränkt)
   Wilhelm Lahann (Geschäftsführer)
   Großwaldstraße 31, 66571 Eppelborn
   Bank1Saar, BLZ 59190000, Konto 111626006
   Ust.ID.:030/111/01126"
   end
  end

bounding_box [420,49], :width =>250 do
   font ("Times-Roman",:size=>9) do
   text "Tel./Fax 06881 962256
   wilhelm.lahann@ips-ug.de
   Sitz Eppelborn/Habach
   HRB 18595"
   end
  end
end
protected
  def brief_schriftgröße 
   font ("Times-Roman",:size=>10) 
  end
  def warning_box text
bounding_box [300,614], :width => 230 do
    font ("Times-Roman",:size=>14) do
      text text, :inline_format=>true,
      :style=> :bold

 end 
  end
  end
  def warning_box2(text1,text2,text3)
bounding_box [300,614], :width => 230 do
    font ("Times-Roman",:size=>12) do
      draw_text  (text1,:style=>:bold, :at=>[(bounds.left+10),bounds.left-15])
      draw_text  (text2,:style=>:bold, :at=>[(bounds.left+10),bounds.left-30])
      draw_text  (text3,:style=>:bold, :at=>[(bounds.left+10),bounds.left-45])
    end
    move_down 53
    stroke do
      line bounds.top_left,    bounds.top_right
      line bounds.bottom_left, bounds.bottom_right
      line bounds.top_left, bounds.bottom_left
      line bounds.top_right, bounds.bottom_right
    end
 end
  end
  def betreff ( text)
    text_box text, :style=>:bold,
      :width    => 400, :height => font.height * 7,
      :overflow => :ellipses, 
      :at       => [20,475],
      :inline_format=>true
  end
  def betreff2 (text)
    bounding_box [20,475], :width=>400 do
       text text, :inline_format=>true ,:style=>:bold,:height => font.height * 7
    end
  end
  def anschreiben ( text)
    bounding_box [20,408], :width => 500 do
       font ("Times-Roman",:size=>10) do
       text  "Sehr geehrte Damen und Herren,"
       move_down 7
       text text, :inline_format=>true 
       end
     end
    bounding_box [80,162], :width => 50  do
       move_down 10
       text "Ort, Datum"
       stroke do
       line bounds.top_left,    bounds.top_right
       end
       end
    bounding_box [180,162], :width => 100  do
       move_down 10
       text "Stempel,Unterschrift"
       stroke do
         line bounds.top_left,    bounds.top_right
       end
    end
    bounding_box [20,120], :width =>200 do
      text "Mit freundlichen Grüßen"
      move_down 20
      text "Wilhelm Lahann
      Geschäftsführer"
    end
  end
  def checkbox_1 
    bounding_box [100,211], :width => 8 ,:height=>8 do
      stroke do
        line bounds.top_left,    bounds.top_right
        line bounds.bottom_left, bounds.bottom_right
        line bounds.top_left, bounds.bottom_left
        line bounds.top_right, bounds.bottom_right
      end
    end
    bounding_box [120,211], :width =>500 do
      text "Ja, bitte veranlassen Sie für obiges Schutzrecht die Einzahlung der nächsten Jahresgebühr."
      end
    end
  def checkbox_2 
    bounding_box [100,198], :width => 8 ,:height=>8 do
      stroke do
        line bounds.top_left,    bounds.top_right
        line bounds.bottom_left, bounds.bottom_right
        line bounds.top_left, bounds.bottom_left
        line bounds.top_right, bounds.bottom_right
       end
      end

    bounding_box [120,198], :width =>500 do
      text "Nein, bitte stellen Sie die administrative Überwachung für das obige Schutzrecht ein."
    end
  end
def betreff_patentanfrage patent 
 betreff(
  )
end
def rechnung(patent ,part1,part2,part3)
  bounding_box [20,408], :width => 500 do
    font ("Times-Roman",:size=>10) do
      text  "Sehr geehrte Damen und Herren,"
      move_down 7
      text part1, :inline_format=>true 
    end
    if patent.submissions.size >1
      font ("Times-Roman",:size=>10) do
        text part2, :inline_format=>true 
      end
      move_down 7
    font ("Times-Roman",:size=>7) do
      items=patent.submissions.map do |item|
        [
          item.submitter.name,
          item.anteil.to_s+'%',
        ]
      end


      table items, :border_style =>:grid,
        :font_size=>9,
        :borders=>[:zero,:top,:zero,:zero],
        :border_width =>1
      move_down patent.submitters.size*7
    end
    end
    font ("Times-Roman",:size=>10) do
      text part3, :inline_format=>true 
    end
  end
end
def address (from,to)
bounding_box [20,665], :width => 300 do
    font("Times-Roman",:size=>9) do
      text  from, :inline_format=>true
    end
    font("Times-Roman",:size=>13) do
      text to, :inline_format=>true
    end
 end

end

end
